# PRP: Fix Server Startup - Routing Error

**Status:** ðŸš¨ URGENT - BLOCKS AUTOMAKER STARTUP
**Created:** 2025-12-28
**Team:** Claude Team (immediate fix)
**Priority:** P0 - Critical

---

## Error

```
PathError [TypeError]: Missing parameter name at index 24: /settings/:projectPath(*)
at createNpmSecurityRoutes (/apps/server/src/routes/npm-security/index.ts:31:10)
```

**Impact:** AutoMaker server cannot start. Application unusable.

---

## Root Cause

Invalid route pattern syntax in npm-security routes:

- **Current (BROKEN):** `/settings/:projectPath(*)`
- **Valid:** `/settings/:projectPath` OR `/settings/:projectPath(.*)`

The `(*)` syntax is not valid in `path-to-regexp`. Must use `(.*)` for wildcard patterns.

---

## Fix Location

**File:** `apps/server/src/routes/npm-security/index.ts:31`

**Search for:**

```typescript
router.get('/settings/:projectPath(*)', ...)
```

**Replace with:**

```typescript
router.get('/settings/:projectPath', ...)
```

**Check for other occurrences:**

```bash
rg "projectPath\(\*\)" apps/server/src/routes/
```

Fix ANY route patterns with `(*)` â†’ remove the `(*)` entirely OR change to `(.*)`

---

## Verification

### 1. Fix Applied

```bash
rg "projectPath\(\*\)" apps/server/src/
```

**Expected:** No results

### 2. Server Starts

```bash
npm run dev:server
```

**Expected:** Server starts without PathError

### 3. Routes Work

```bash
curl http://localhost:3008/api/npm-security/settings/test-project
```

**Expected:** Returns settings (or 404 if not configured, but NOT a route error)

---

## Checklist

- [ ] Find all routes with `(*)` pattern
- [ ] Fix to remove `(*)` or change to `(.*)`
- [ ] Verify no other malformed route patterns exist
- [ ] Test server startup
- [ ] Test affected endpoints respond

---

## Additional Scan

Check for other potential route issues introduced during Executive Suite work:

```bash
# Check all route definitions in npm-security
rg "router\.(get|post|put|delete)\(" apps/server/src/routes/npm-security/

# Check settings routes
rg "router\.(get|post|put|delete)\(" apps/server/src/routes/settings/
```

Look for any unusual patterns like:

- `(*)` without a dot
- Unclosed parentheses
- Missing colons before params

---

## Timeline

**Estimated fix time:** 2-5 minutes

**Steps:**

1. Read `apps/server/src/routes/npm-security/index.ts`
2. Find line ~31 with malformed pattern
3. Fix pattern
4. Verify no other instances
5. Test server startup

---

_Generated by BMAD Party Mode - Emergency Response_
